# XLSX N-th Min Finder

Сервис на Spring Boot. Принимает путь к локальному `.xlsx` файлу, берёт числа из первого столбца и возвращает N-ое минимальное число (элемент, который стоял бы на позиции N, если отсортировать по возрастанию).

---

## Требования
- Java 21
- Интернет
- (опционально) Docker, если запускать в контейнере

---

## Вариант 1: запуск через Gradle

```bash
./gradlew bootRun
```

## Вариант 2: запуск через Docker

```bash
docker build -t min-finder .
docker run -p 8080:8080 -v ${PWD}/test-data:/data min-finder
```

---

После запуска приложение будет доступно по адресу:

http://localhost:8080

Swagger UI:

http://localhost:8080/swagger-ui/index.html?url=/openapi.json#

---

## Пример запроса

GET http://localhost:8080/api/v1/finder/min-nth?path=C:\temp\test.xlsx&n=3

где:
- `path` — абсолютный путь к xlsx файлу на вашей машине
- `n` — порядковый номер минимального числа (1 = минимальное, 2 = второе минимальное и т.д.)

Для удобства тестирования в директории `test-data` лежит файл `test.xlsx` с 100 000 элементов (от 10.000.000 до 9.900.000, в порядке убывания).

При запуске через Docker, путь к файлу будет `/data/test.xlsx`.

---

## Summary

Для поиска минимального элемента используется модифицированный алгоритм Quick Select. 
- best/average case: O(n)
- worst case: O(n^2) (на практике почти невозможно достичь)

Добавил логирование времени, в среднем на сам алгоритм уходит 1-3мс. На парсинг файла (примитивный) уходит в разы больше - в ТЗ было указано сделать упор в скорость самого алгоритма поиска и не тратить много времени на само тестовое задание. Но я бы конечно поменял подход к парсингу файла, если бы конечное использование алгоритма на самом деле тербовало бы парсинг.

Так же не помешало бы добавить обработчик исключений адекватный, но опять таки, в ТЗ было указано не тратить время на доп. функционал.